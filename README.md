```
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢀⣀⣤⣤⣴⣶⡆⠀⣶⣶⣦⣤⣤⣄⠀ ⢠⣾⣿⣦
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣀⡀⢰⣿⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⡄⠘⢿⣿⠟
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⢀⣴⣾⣿⣧⠀⢻⣿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⣿⠂⢠⣠⣤⣶⣦⡀
                                    ⠀⠀⠀⠀⠀⠀⣠⣾⣿⣿⣿⣿⣿⣇⠈⢿⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⣿⠏⢀⣿⣿⣿⣿⣿⣿⣦⡀
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⣿⣿⡆⠘⣿⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⣿⡏⠀⣾⣿⣿⣿⣿⣿⣿⡿⠋⢀
                                    ⠀⠀⠀⣴⣿⣦⡀⠙⢿⣿⣿⣿⣿⣿⣿⡄⠸⣿⣿⣿⣿⡇⠀⣿⣿⣿⣿⡟⠀⣼⣿⣿⣿⣿⣿⣿⠟⢀⣴⣿⣧
                                    ⠀⠀⣼⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣿⣷⡀⢹⣿⣿⣿⡇⠀⣿⣿⣿⡿⠁⣰⣿⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣧
                                    ⠀⣼⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣿⣧⠀⢻⣿⣿⡇⠀⣿⣿⣿⠃⢰⣿⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⠀⠛⠿⢿⣿⣿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⣿⣇⠀⢿⣿⡇⠀⣿⣿⠇⢠⣿⣿⣿⠟⢁⣴⣿⣿⣿⣿⣿⣿⣿⣿⡿⠟⠃
                                    ⣼⣶⣤⣄⡈⠙⠛⠿⣿⣿⣿⣿⣿⣦⡀⠙⢿⣿⡆⠈⠛⠃⠀⠛⠋⠀⣾⣿⠟⠁⣠⣾⣿⣿⣿⣿⡿⠿⠛⠉⣀⣠⣴⣶⡄
                                    ⣿⣿⣿⣿⣿⣿⣶⣤⣀⡉⠙⠻⢿⣿⣿⣦⠀⠁⠀⠀⠀⠀⠀⠀⠀⠀⠈⠁⢠⣾⣿⣿⠿⠛⠋⢁⣠⣴⣶⣿⣿⣿⣿⣿⣿⡀
                                    ⢻⣿⣿⣿⣿⣿⣿⣿⣿⣿⣷⣦⣤⣀⠉⠃⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠋⢁⣀⣤⣶⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣧
                                    ⢸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡏⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡟⠁⠀⣠⣶⣄
                                    ⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⣤⡄⠀ ⢻⣿⣿⡿
                                    ⠀⠘⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠿⠓⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⣸⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠂⠀⠈⠙⠋
                                    ⠀⠀⠘⣿⣿⣿⣿⣿⠿⠛⠋⢁⣠⣤⣶⣧⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⢰⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠟⠋
                                    ⠀⠀⠀⠘⠟⠋⢉⣀⣤⣶⣿⣿⣿⣿⠟⠁⣠⣦⣄⡀⠀⠀⠀⠀⠀⠀⣤⣦⡈⠻⣿⣿⣿⣿⣿⣿⣿⣿⣿⡿⠛⠁
                                    ⠀⠀⠀⠀⠀⠘⢿⣿⣿⣿⣿⣿⠟⠁⣠⣾⣿⣿⣿⣿⣿⣶⣶⣾⣧⠀⢻⣿⣿⣦⡈⠻⣿⣿⣿⣿⡿⠟⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠙⠿⣿⡟⠁⣠⣾⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣇⠈⠿⢿⣿⣿⣦⡈⠻⠛⠉
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠈⠀⠺⢿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⣿⠋⢀⣤⣤⡈⠙⠋⠁
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠉⠙⠛⠻⠿⠿⠿⠿⠿⠿⠇⠀ ⣿⣿⣿⡇
                                    ⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀⠀   ⠈⠙⠋

                         /██   /██   /██   /██   /██████    /██████     /██████    /██      /██   /███████
                        | ██  | ██  | ███ | ██  |_  ██_/   /██__  ██   /██__  ██  | ███    /███  | ██__  ██
                        | ██  | ██  | ████| ██    | ██    | ██  \__/  | ██  \ ██  | ████  /████  | ██  \ ██
                        | ██  | ██  | ██ ██ ██    | ██    | ██        | ████████  | ██ ██/██ ██  | ███████/
                        | ██  | ██  | ██  ████    | ██    | ██        | ██__  ██  | ██  ███| ██  | ██____/
                        | ██  | ██  | ██\  ███    | ██    | ██    ██  | ██  | ██  | ██\  █ | ██  | ██
                        |  ██████/  | ██ \  ██   /██████  |  ██████/  | ██  | ██  | ██ \/  | ██  | ██
                         \______/   |__/  \__/  |______/   \______/   |__/  |__/  |__/     |__/  |__/
```
<p align="right"><b><sub>Version: 1.0.0</sub></b></p>

<p align="center"><b>Authors</b></p>
<p align="center">
Nathan Barros de Souza<br>
Luís Fernando Mercier Franco<br></p>

# <p align="center">NPT/NVT-Monte Carlo Simulation of Mixtures of <br>Anisomorphic Hard Convex Bodies: <br>Ellipsoids of revolution, Spherocylinders, and Cylinders</p>

## Contents
1. [Disclaimer](#disclaimer)
2. [Overview](#overview)
3. [Features](#features)
4. [Language](#language)
5. [Building and Compiling](#installation)
6. [Data Input](#datainput)
7. [Files and Folders](#filesandfolders)
8. [Reporting Errors](#reporting)
9. [Citing Us](#citation)

## <a name="disclaimer"></a>Disclaimer

<p align="justify">
The authors make no warranties about the use of this software. The authors hold no liabilities for the use of this software. The authors do not 
 recommend the use of this software whatsoever. The algorithm is made freely available to assist researchers in studies involving mixtures of hard convex bodies.
 All information contained herein regarding any specific methodology does not constitute or imply its endorsement or recommendation by the authors.
</p>

## <a name="overview"></a>Overview
<p align="justify">
  This NVT/NPT-Monte Carlo algorithm was designed to evaluate the thermodynamic behavior of mixtures of anisomorphic hard convex bodies (HCB), namely: ellipsoids of revolution (EOR), spherocylinders (SPC), and cylinders (CYL). Here, the HCB interact only through a purely repulsive hard-core potential, which means that a single check of overlapping configurations is sufficient to validate a random trial move. To search for overlapping configurations, different methods were applied depending on the molecular geometry: for mixtures of anisomorphic EOR particles, the Perram-Wertheim (PW) method (<a href="https://doi.org/10.1016/0021-9991(85)90171-8"><b>J. Comput. Phys.</b>, 58, 409-416, 1985</a>) is used; for mixtures of anisomorphic SPC particles, the Vega-Lago (VL) method (<a href="https://doi.org/10.1016/0097-8485(94)80023-5"><b>Comput. Chem.</b>, 18, 55-59, 1994</a>) is used; and for mixtures of CYL particles, the enhanced Orellana <i>et al.</i> (ECYL) algorithm (<a href="https://doi.org/10.1063/5.0040942"><b>J. Chem. Phys.</b>, 154, 104902, 2021</a>) is used.
</p>

<p align="justify">
  This NVT/NPT-Monte Carlo algorithm only treats mixtures of anisomorphic HCB, that is, mixtures of HCB with same geometry but different aspect ratios. Mixtures of isomorphic HCB (pure components) are also possible. The geometries are illustrated below.
</p>

| | | |
|:---:|:---:|:---:|
| | | |
| **Oblate Ellipsoids of Revolution** | **Spheres (Degenerate)** | **Prolate Ellipsoids of revolution** |
| ![oblate_eor](https://user-images.githubusercontent.com/73966482/220217625-863c0551-3e97-4199-860f-f436746c32da.gif) | ![sphere_eor](https://user-images.githubusercontent.com/73966482/220217633-d9a5dc8b-d624-456a-86d8-22f5d5bb6954.gif) | ![prolate_eor](https://user-images.githubusercontent.com/73966482/220217635-92cd7b1e-c5ef-41a6-af07-f52981402b5e.gif) |
| **Thin Spherocylinders** | **Spheres (Degenerate)** | **Thick Spherocylinders** |
| ![short_rod](https://user-images.githubusercontent.com/73966482/220220955-c1020dbe-1ed1-439a-82b5-4b9285e0deab.gif) | ![sphere_eor](https://user-images.githubusercontent.com/73966482/220217633-d9a5dc8b-d624-456a-86d8-22f5d5bb6954.gif) | ![long_rod](https://user-images.githubusercontent.com/73966482/220221125-03a64ead-b267-42fc-8693-2e71b2e91ca3.gif) |
| **Oblate Cylinders** | **Equilateral Cylinders** | **Prolate Cylinders** |
| ![oblate_cyl](https://user-images.githubusercontent.com/73966482/220222417-9817f7b8-2905-44de-a75f-bb5723921b89.gif) | ![equilateral_cyl](https://user-images.githubusercontent.com/73966482/220222480-c467f205-8ca0-4434-b1ed-328b12710627.gif) | ![prolate_cyl](https://user-images.githubusercontent.com/73966482/220222442-54428487-292d-4050-9bb5-1a3db933ac3a.gif) |
| | | |

<p align="justify">
  This NVT/NPT-Monte Carlo algorithm can be used, <i>e. g.</i>, for mixtures of oblate and prolate ellipsoids of revolution, oblate/prolate ellipsoids of revolution and spheres (degenerate case), thin and thick spherocylinders, thin/thick spherocylinders and spheres (degenerate case), oblate (disk) and prolate (rod) cylinders, oblate/prolate cylinders and equilateral cylinders, etc. The algorithm cannot yet be used for mixtures of cylinders and spheres. Some NVT-Monte Carlo simulations of  these multicomponent mixtures are illustrated below.
</p>

| | | |
|:---:|:---:|:---:|
| | | |
| NVT-Monte Carlo (EOR) | NVT-Monte Carlo (SPC) | NVT-Monte Carlo (CYL) |
| ![all_eor](https://user-images.githubusercontent.com/73966482/220226516-0ac6a160-2d06-4100-bdc4-75cd84a28adb.gif) | ![all_spc](https://user-images.githubusercontent.com/73966482/220227393-6c56c6c4-5857-4388-ad79-98e78814d81d.gif) | ![all_cyl](https://user-images.githubusercontent.com/73966482/220225783-9bcec901-1fa2-4a65-954c-cfda4d942b5d.gif) |
| | | |

## <a name="features"></a>Features
<p align="justify">
The following features are supported in the current version:
</p>

1. Initial Configurations
    - Simple Cube (for pure components only)
    - Body-Centered Cube (for pure components only)
    - Face-Centered Cube (for pure components only)
    - Random Structure (for pure components and mixtures)

2. Ensembles
    - Canonical (NVT)
    - Isothermal-Isobaric (NPT)
    - Isothermal-Isostress (N&sigma;T)

3. Moves
    - Translation
    - Rotation (Quaternion Algebra)
    - Cubic Expansions/Compressions (Isotropic)
    - Triclinic Expansions/Compressions (Anisotropic)

4. Potentials
    - None

## <a name="language"></a>Language
<p align="justify">
  The main program, subroutines, modules, and functions contain some explanatory comments and are mainly written in Fortran 95. The user can look for more information on Fortran language <a href="https://docs.oracle.com/cd/E19957-01/806-3591/C_f95.html">here</a>.
</p>

## <a name="installation"></a>Building and Compiling
<p align="justify">
  Firstly, you must clone this GitHub repository using the command below:
</p>

```
> git clone https://github.com/LESC-Unicamp/monte_carlo_mixtures_ellipsoids_spherocylinders_cylinders
```

<p align="justify">
  After that, change to the repository directory on your device and open the <code>/Src/</code> folder:
</p>

```
> cd monte_carlo_mixtures_ellipsoids_spherocylinders_cylinders/src/
```

<p align="justify">
  The <code>/src/</code> folder contains two 'Makefiles' that you can use to compile the code. Each of these 'Makefiles' contains different compilation options. You can use either the 'makefile' to compile the standard version of the code or the 'makefile-debug' to compile the debug version of the code.
</p>

<p align="justify">
  To compile it, first remove any object and module files using the <i>clean</i> command:
</p>
  
```> make clean```

<p align="justify">
  Then, to compile the source code, run one of the commands below, depending on the chosen compilation type:
</p>

| **Compilation type** | **Command** |
|:---:|:---:|
| Debug | ```make -f makefile.debug``` |
| Standard | ```make -f makefile``` |

<p align="justify">
  Each of these commands will produce an executable with a specific name depending on the chosen compilation type. Both executables can be found in the folder <code>/bin/</code> in the repository directory. Before running the program, there are a few initialization variables and options you need to set up.
</p>

## <a name="datainput"></a>Data Input

<p align="justify">
  Apart from the executable file, the <code>/bin/</code> folder contains some initialization files that need to be set up.
</p>

### The Configuration File<br> <sub><code>ini_config.ini</code></sub>

<p align="justify">
  This file is used to set up the molecular geometry and the molecular configuration, including aditional information on the random structure (if selected). The table below shows some options that can be used to define the configuration parameters:
</p>

| Name | String Name | Definition | Options |
|:---:|:---:|:---:| --- |
| <img width=200/> |:---:|:---:| --- |
| Geometry selection | <code>geometry_selection</code> | Used to select the molecular geometry | <ul><li><code>EOR</code> for ellipsoids of revolution</li><li><code>SPC</code> for spherocylinders</li><li><code>CYL</code> for cylinders</li></ul> |
| Configuration selection | <code>molecular_configuration</code> | Used to select the initial configuration | <ul><li><code>SC</code> for a simple cubic structure</li><li><code>BCC</code> for a body-centered cubic structure</li><li><code>FCC</code> for a face-centered cubic structure</li><li><code>RND</code> for a random cubic structure</li></ul> |
| Unrotated axis | <code>unrotated_axis</code> | Used to select the unrotated reference axis<br> (initial configurations only) | <ul><li><code>X</code> to select the _x_-axis</li><li><code>Y</code> to select the _y_-axis</li><li><code>Z</code> to select the _z_-axis</li></ul> |
| Quaternion angle | <code>quaternion_angle</code> | Used to select the orientation angle (initial configurations only) | Any <code>FLOAT</code> number |
| Maximum attempts<br> (<code>RND</code> only) | <code>max_attempts_rnd</code> | Used to select the maximum number of attempts to randomly allocate particle inside a cubic box (random configuration only) | Any non-zero, positive <code>INTEGER</code> number |

### The Control File<br> <sub><code>ini_control.ini</code></sub>

### The Monte Carlo File<br> <sub><code>ini_montecarlo.ini</code></sub>

### The Probabilities File<br> <sub><code>ini_probabilities.ini</code></sub>

### The Acceptance Ratios File<br> <sub><code>ini_ratio.ini</code></sub>

### The System File<br> <sub><code>ini_system.ini</code></sub>

    * The molecular configuration: `<SC>` for a simple cubic structure, `<BCC>` for a body-centered cubic structure, `<FCC>` for a face-centered cubic structure, and `<RND>` for a random cubic structure
    * The unrotated reference axis (initial configuration only): `<SC>` for the X-axis
    * The

2. a
3. a
4. a
5. 

a configuration file for selecting the molecular geometry and the molecular configuration, including some aditional information on the 'Random' structure (if selected); <b>II</b> a control file

## <a name="filesandfolders"></a>Files and Folders

## <a name="reporting"></a>Reporting Errors
<p align="justify">
  If you spot an error in the program files and all other documentation, please submit an issue report using the <a href="https://github.com/LESC-Unicamp/monte_carlo_mixtures_ellipsoids_spherocylinders_cylinders/issues">Issues</a> tab.
</p>

## <a name="citation"></a>Citing Us

---

“<i>With thermodynamics, one can calculate almost everything crudely; with kinetic theory, one can calculate fewer things, but more accurately; and with statistical mechanics, one can calculate almost nothing exactly.</i>” -- Eugene P. Wigner
